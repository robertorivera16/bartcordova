<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, maximum-scale=1">
		<meta name="format-detection" content="telephone=no">
		<meta name="author" content="Simon Prickett">
		<meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'">
		<title>BART Cordova</title>
		<!-- Bootstrap, Font-Awesome and Custom app CSS overrides -->
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="font-awesome-4.4.0/css/font-awesome.min.css" rel="stylesheet">
		<link href="css/custom.css" rel="stylesheet">

		<!-- Handlebars Templates -->
		<script id="stationListPageTemplate" type="text/x-handlebars-template">
			<div id="title">
			</div>
			<div id="systemStatus">
			</div>
			<div id="closestStation">
			</div>
			<div id="stationList">
			</div>
		</script>

		<script id="stationDetailPageTemplate" type="text/x-handlebars-template">
			<div id="stationHeader">
			</div>
			<div id="stationDepartures">
			</div>
		</script>

		<script id="stationListHeaderTemplate" type="text/x-handlebars-template">
			<div class="pull-right">
				<button type="button" class="btn btn-default btn-sm" id="reloadButton">
  					<span class="glyphicon glyphicon-refresh"></span>
  				</button>
  			</div>
			<h3><i class="fa fa-subway"></i> BART Departures</h3>
		</script>

		<script id="stationListTemplate" type="text/x-handlebars-template">
			<div class="panel panel-default" id="stationListPanel">
				<ul class="list-group" id="stations">
					{{#each stations}}
						<li id="{{abbr}}" class="list-group-item">{{{formatStationName name}}}</li>
					{{/each}}
				</ul>
			</div>
		</script>

		<script id="closestStationTemplate" type="text/x-handlebars-template">
			<div class="alert alert-info alert-dismissable" role="alert">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<span id="nearestStationButton"><strong><i class="fa fa-location-arrow"></i>
 Closest</strong> - {{{formatStationName station.name}}} ({{round station.distance}} miles)</span>
			</div>
		</script>

		<script id="serviceAnnouncementTemplate" type="text/x-handlebars-template">
			<div class="alert alert-danger alert-dismissable" role="alert">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<strong><i class="fa fa-exclamation-triangle"></i>&nbsp;<i class="fa fa-clock-o"></i>
 {{formatTime announcement.time}}</strong> - {{announcement.bsa.description}}
			</div>
		</script>

		<script id="trainCountTemplate" type="text/x-handlebars-template">
			<div class="alert alert-success alert-dismissable" role="alert">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<strong><i class="fa fa-info-circle"></i>&nbsp;<i class="fa fa-clock-o"></i>
 {{formatTime systemStatus.time}}</strong> - {{systemStatus.traincount}} trains operating.
			</div>
		</script>

		<script id="stationHeaderTemplate" type="text/x-handlebars-template">
			<button type="button" class="btn btn-primary btn-sm" id="backButton"> <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Back</button>
			<div class="pull-right">
				<button type="button" class="btn btn-default btn-sm" id="reloadButton">
  					<span class="glyphicon glyphicon-refresh"></span>
  				</button>
  			</div>
			<h4>{{{formatStationName stationName}}}</h4>
			<ul class="nav nav-tabs stationTabs">
  				<li class="active"><a href="#departures" data-toggle="tab">Departures</a></li>
  				<li ><a href="#info" data-toggle="tab">Info</a></li>
  				<li ><a href="#tickets" data-toggle="tab">Tickets</a></li>
			</ul>
		</script>

		<script id="stationDeparturesTemplate" type="text/x-handlebars-template">
			<div class="tab-content">
				<div id="departures" class="tab-pane fade in active">
					{{#each destinations}}
						<div class="panel panel-info">
							<div class="panel-heading stationDetailLink" id="{{abbreviation}}">
								<h3 class="panel-title">{{{formatStationName destination}}} <span class="platform">(Platform {{estimate.[0].platform}})</span></h3>
							</div>
							<div class="panel-body">
								<ul class="list-group">
									{{#each estimate}}
										<li class="list-group-item line{{color}}">{{{formatTrainIcon minutes}}} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{formatMins minutes}}, {{length}} cars</li>
									{{/each}}
								</ul>
							</div>
						</div>
					{{else}}
						<div class="panel panel-danger">
						  	<div class="panel-heading">
    							<h3 class="panel-title">No Departures</h3>
  							</div>
  							<div class="panel-body">
    							<i class="fa fa-exclamation-triangle"></i> 
    							Real time departures are not available for this station right now.
  							</div>
						</div>
					{{/each}}
				</div>
				<div id="info" class="tab-pane fade">
					<div class="panel panel-info">
						<div class="panel-heading">
							<h3 class="panel-title"><i class="fa fa-map"></i> Location {{#if isiOS}}<a href="maps:ll={{station.gtfs_latitude}},{{station.gtfs_longitude}}&z=18">{{else}}<a href="geo:{{station.gtfs_latitude}},{{station.gtfs_longitude}}&z=18">{{/if}}<i class="fa fa-external-link pull-right"></i></a></h3> 
						</div>
						<div class="panel-body">
							{{#if isiOS}}
								<a href="maps:ll={{station.gtfs_latitude}},{{station.gtfs_longitude}}&z=18">
							{{else}}
								<a href="geo:{{station.gtfs_latitude}},{{station.gtfs_longitude}}&z=18">
							{{/if}}
							<img class="img-responsive" src="https://maps.googleapis.com/maps/api/staticmap?key=AIzaSyCjoixPZLk1UWPeKb9woea0etMiY2ZdKkQ&zoom=18&size=450x450&maptype=roadmap&markers=color:red%7C{{station.gtfs_latitude}},{{station.gtfs_longitude}}" alt="Station Location Map"/>
							</a>
							{{station.address}}
							<br/>
							{{station.city}} {{station.state}}, {{station.zipcode}}
						</div>
					</div>
					<div class="panel panel-info">
						<div class="panel-heading">
							<h3 class="panel-title"><i class="fa fa-bicycle"></i> For Cyclists</h3>
						</div>
						<div class="panel-body">
							<h4>Bike Lockers</h4>
							{{{stationAccess.lockers}}}
							{{#if stationAccess.bike_station_text}}
								<h4>Bike Station</h4>
								{{{stationAccess.bike_station_text}}}
							{{/if}}
						</div>
					</div>
					<div class="panel panel-info">
						<div class="panel-heading">
							<h3 class="panel-title"><i class="fa fa-car"></i> Parking</h3>
						</div>
						<div class="panel-body">
							{{#if stationAccess.fill_time}}
								<strong>Expect parking to be full by {{stationAccess.fill_time}}.</strong>
								<hr/>
							{{/if}}
							{{{stationAccess.parking}}}
						</div>
					</div>
					<div class="panel panel-info">
						<div class="panel-heading">
							<h3 class="panel-title"><i class="fa fa-wheelchair"> Accessibility</i></h3>
						</div>
						<div class="panel-body">
							{{{stationAccess.entering}}}
						</div>
					</div>
				</div>
				<div id="tickets" class="tab-pane fade">
					<div class="panel panel-danger">
						<div class="panel-heading">
							<h3 class="panel-title"><i class="fa fa-ticket"></i> Not Available</h3> 
						</div>
						<div class="panel-body">
							<i class="fa fa-exclamation-triangle"></i> Sorry, this feature is not yet available.
						</div>
					</div>
				</div>
			</div>
		</script>
	</head>
	<body>
		<nav class="navbar navbar-fixed-top">
			<div class="container">
    			<div class="navbar-header">
    			</div>
		    </div>
		</nav>
		<div class="container" id="app">
		</div>

		<!-- Cordova JS -->
		<script type="text/javascript" src="cordova.js"></script>

		<!-- JQuery and Bootstrap JS -->
		<script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
		<script type="text/javascript" src="js/bootstrap.min.js"></script>

		<!-- Handlebars JS -->
		<script type="text/javascript" src="js/handlebars.min.js"></script>

		<!-- Application JS -->
		<script type="text/javascript" src="js/app.js"></script>
	</body>
</html>
